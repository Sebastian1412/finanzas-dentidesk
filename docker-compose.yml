services:
  app:
    build: .
    container_name: dentidesk_app
    ports:
      # Expose your app on http://localhost:8080
      - "8080:80"
    volumes:
      # --- CORRECTION ---
      # This ensures your code is placed in the subfolder
      # that your app.js and Dockerfile expect.
      - ./backend:/var/www/html/proyectos/finanzas-dentidesk/backend
      - ./frontend:/var/www/html/proyectos/finanzas-dentidesk/frontend
    environment:
      # Variables for PHP to connect to the DB
      DB_HOST: db
      DB_NAME: finanzas_db
      DB_USER: root
      DB_PASS: root_password_seguro
    depends_on:
      - db 

  # --- The Database Service ---
  db:
    image: mysql:8.0
    container_name: dentidesk_db
    environment:
      MYSQL_ROOT_PASSWORD: "root_password_seguro" # 'root' password
      MYSQL_DATABASE: "finanzas_db" 
    volumes:
      # Automatically loads the init.sql script on first run
      - ./docker/db-init:/docker-entrypoint-initdb.d
    ports:
      # (Optional) Expose the DB to your PC on port 3307
      - "3307:3306"